# Agent Management System

A modern, FastAPI-based application for managing intelligence agents with PostgreSQL database.

## Features

- **CRUD Operations**: Create, read, update, and delete agents
- **Advanced Queries**: Filter by status, get top performers, pagination
- **Data Validation**: Comprehensive input validation with Pydantic
- **Async Database**: High-performance async PostgreSQL operations
- **RESTful API**: Clean, well-documented REST endpoints
- **OpenAPI Documentation**: Interactive API docs with Swagger UI

## Tech Stack

- **Backend**: Python 3.8+
- **Framework**: FastAPI
- **Database**: PostgreSQL
- **ORM**: SQLAlchemy 2.0 (async)
- **Validation**: Pydantic

## Project Structure

```
AgentProject/
├── app/
│   ├── models/          # Database models
│   ├── database/        # Database connection and configuration
│   ├── services/        # Business logic layer
│   └── api/            # API routes and schemas
├── requirements.txt    # Python dependencies
├── console_app.py      # Console App
├── config.py          # Application configuration
├── main.py            # FastAPI application entry point
└── README.md          # This file
```

## Database Schema

The application uses the existing PostgreSQL `agents` table from the C# project:

```sql
CREATE TABLE agents (
    id INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    codename VARCHAR(50) NOT NULL UNIQUE,
    realname VARCHAR(100) NOT NULL,
    location VARCHAR(100) NOT NULL,
    status VARCHAR(20) NOT NULL,
    missionscompleted INTEGER NOT NULL DEFAULT 0
);
```

## Installation

1. **Clone the repository**:
   ```bash
   git clone <repository-url>
   cd AgentProject
   ```

2. **Create virtual environment**:
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```

3. **Install dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Configure environment**:
   Create a `.env` file in the root directory:
   ```env
   DATABASE_URL=postgresql+asyncpg://username:password@localhost:5432/Agents_DB
   APP_NAME=Agent Management System
   DEBUG=True
   HOST=0.0.0.0
   PORT=8000
   SECRET_KEY=your-secret-key-here-change-in-production
   ```

5. **Update database connection**:
   Replace the `DATABASE_URL` in `.env` with your actual PostgreSQL connection string.

## Running the Application

### Development Mode
```bash
python main.py
```

### Production Mode
```bash
uvicorn main:app --host 0.0.0.0 --port 8000
```

The application will be available at:
- **API**: http://localhost:8000
- **Interactive Docs**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## API Endpoints

### Agents

| Method | Endpoint | Description |
|--------|----------|-------------|
| `POST` | `/api/v1/agents/` | Create a new agent |
| `GET` | `/api/v1/agents/` | Get all agents (with pagination) |
| `GET` | `/api/v1/agents/{id}` | Get agent by ID |
| `GET` | `/api/v1/agents/codename/{codename}` | Get agent by codename |
| `PUT` | `/api/v1/agents/{id}` | Update agent |
| `DELETE` | `/api/v1/agents/{id}` | Delete agent |
| `PATCH` | `/api/v1/agents/{id}/increment-missions` | Increment missions count |
| `PATCH` | `/api/v1/agents/{id}/status` | Update agent status |
| `GET` | `/api/v1/agents/status/{status}` | Get agents by status |
| `GET` | `/api/v1/agents/top-performers/` | Get top performing agents |

### Query Parameters

- `skip`: Number of records to skip (pagination)
- `limit`: Number of records to return (max 1000)
- `status`: Filter by agent status
- `limit`: Number of top performers to return

### Agent Status Values

- `active`: Agent is currently active
- `inactive`: Agent is inactive
- `on_mission`: Agent is currently on a mission
- `retired`: Agent has retired
- `deceased`: Agent is deceased

## Example Usage

### Create an Agent
```bash
curl -X POST "http://localhost:8000/api/v1/agents/" \
  -H "Content-Type: application/json" \
  -d '{
    "codename": "AGENT_007",
    "realname": "James Bond",
    "location": "London",
    "status": "active",
    "missionscompleted": 0
  }'
```

### Get All Agents
```bash
curl "http://localhost:8000/api/v1/agents/?skip=0&limit=10"
```

### Get Top Performers
```bash
curl "http://localhost:8000/api/v1/agents/top-performers/?limit=5"
```

### Update Agent Status
```bash
curl -X PATCH "http://localhost:8000/api/v1/agents/1/status?status=on_mission"
```
```
## Development

### Git Branching Strategy

```
main (production)
├── develop 
├── feature/data-layer
├── feature/api-endpoints  
├── feature/console-cli
```

### Code Style

The project follows PEP 8 guidelines. Use a code formatter like `black`:
```bash
pip install black
black .
```

## Contributing

1. Create a feature branch from `develop`
2. Make your changes
3. Add tests for new functionality
4. Ensure all tests pass
5. Submit a pull request

## License

This project is licensed under the MIT License.

## Support

For support and questions, please contact the development team. 